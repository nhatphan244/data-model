I have to 2 python files:
govmaster_crawler.py
from sqlalchemy import create_engine
import pandas as pd
import re


def db_connect():
    server = 'localhost'
    database = 'GovMaster'
    username = 'sql_developer'
    password = '12345'
    driver = 'ODBC Driver 17 for SQL Server'

    connection_string = f'mssql+pyodbc://{username}:{password}@{server}/{database}?driver={driver}'

    engine = create_engine(connection_string)
    return engine

def get_all(query, engine):
    try:
        with engine.connect() as connection:
            result = connection.execute(query).fetchall()
            result_dicts = [dict(row) for row in result]
            return result_dicts
    except Exception as e:
        print(f"Error occurred: {e}")
        return []

def get_gov_master_list(engine):
    query = """
        SELECT g.province_id, g.province_name, g.district_id, 
               g.district_name, g.ward_id, g.ward_name 
        FROM gov_master g
    """
    result = get_all(query, engine)
    return result

def migrate_dataframe(engine):
    gov_master_list = get_gov_master_list(engine)
    df_gov_master = pd.DataFrame(gov_master_list)
    return df_gov_master


def get_ward(ward, district, province, df_gov_master):
    result = df_gov_master[(df_gov_master["province_name"] == province) & 
                            (df_gov_master["district_name"] == district) & 
                            (df_gov_master["ward_name"] == ward)]
   
    if not result.empty:
        return result.head(1)
    return [] 


def main():
    try:
        engine = db_connect()
        print("Connection established")
    except Exception as e:
        print(f"Error connecting to the database: {e}")
        return
    
    # Migrate data from GovMaster database to DataFrame
    df_gov_master = migrate_dataframe(engine)
    print("\nDataFrame of Gov Masters:")
    print(df_gov_master)

    print("\nTesting get_ward:")
    ward = "Xã Viên An Đông"
    district = "Huyện Ngọc Hiển"
    province = "Tỉnh Cà Mau"
    ward_result = get_ward(ward, district, province, df_gov_master)
    print("Result for ward:", ward_result)

    # Print the DataFrame of Gov Masters
    print("\nDataFrame of Gov Masters:")

if __name__ == "__main__":
    main()
and databawse 
