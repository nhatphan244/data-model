import requests
import osmnx as ox
import matplotlib.pyplot as plt

def fetch_and_save_osm_data(relation_id, filename="relation.txt"):
    overpass_url = "http://overpass-api.de/api/interpreter"
    overpass_query = f"""
    [out:xml][timeout:25];
    (relation({relation_id});
    );
    out body;
    >;
    out skel qt;
    """
    response = requests.get(overpass_url, params={'data': overpass_query})
    # Save response content to a text file in text mode
    with open(filename, 'w', encoding='utf-8') as file:
        file.write(response.text)  # using response.text to handle text data

def plot_osm_file(filename="relation.txt"):
    # Load the graph from OSM file
    G = ox.graph_from_xml(filename, simplify=True)
    # Plot the graph
    ox.plot_graph(G)

def main():
    relation_id = 9806914  # Replace this with your desired relation ID
    fetch_and_save_osm_data(relation_id)
    plot_osm_file()

if __name__ == "__main__":
    main()
