# Define data types for SQL Server to ensure compatibility
from sqlalchemy.types import Integer, NVARCHAR, Unicode

# Specify the data types for each column that corresponds to SQL table structure
province_dtypes = {
    "id": Integer(),
    "province_name": NVARCHAR(length=255),
    "province_name_unsigned": NVARCHAR(length=255)
}

district_dtypes = {
    "id": Integer(),
    "district_name": NVARCHAR(length=255),
    "district_name_unsigned": NVARCHAR(length=255)
}

ward_dtypes = {
    "id": Integer(),
    "ward_name": NVARCHAR(length=255),
    "ward_name_unsigned": NVARCHAR(length=255)
}

gov_master_dtypes = {
    "province_id": Integer(),
    "province_name": NVARCHAR(length=255),
    "province_name_unsigned": NVARCHAR(length=255),
    "district_id": Integer(),
    "district_name": NVARCHAR(length=255),
    "district_name_unsigned": NVARCHAR(length=255),
    "ward_id": Integer(),
    "ward_name": NVARCHAR(length=255),
    "ward_name_unsigned": NVARCHAR(length=255)
}

# Use to_sql method to insert data into each table
province_df.to_sql('province', con=engine, if_exists='append', index=False, dtype=province_dtypes)
district_df.to_sql('district', con=engine, if_exists='append', index=False, dtype=district_dtypes)
ward_df.to_sql('ward', con=engine, if_exists='append', index=False, dtype=ward_dtypes)
gov_master_df.to_sql('gov_master', con=engine, if_exists='append', index=False, dtype=gov_master_dtypes)
